# MySQL

## Создание и удаление базы данных
```SQL
SHOW DATABASES имя_базы_даных; - Вывести все базы данных

CREATE DATABASE имя_базы_даных; - Создать базу данных, если она есть вернет ошибку

CREATE DATABASE IF NOT EXISTS имя_базы_даных; - Создать базу данных если ее нет

USE имя_базы_даных; - Установка базы данных

DROP DATABASE имя_базы_даных; - Удалить базу данных. Если ее нет вернет ошибку

DROP DATABASE [IF EXISTS] имя_базы_даных; - Удалить базу данных если она есть
```

## Создание и удаление таблиц
>**CREATE TABLE** название_таблицы
>
>(название_столбца1 тип_данных атрибуты_столбца1,
>
> ................................................
>
> название_столбцаN тип_данных атрибуты_столбцаN,
>
> атрибуты_уровня_таблицы
>)

```SQL
CREATE TABLE Customers (Id INT);
```

`RENAME TABLE старое_название TO новое_название;` - переименование таблицы

`TRUNCATE TABLE название_таблицы;` - удалить данные в таблице

`DROP TABLE название_таблицы;` - удаление таблицы

## Атрибуты столбцов и таблиц
`PRIMARY KEY` - задает первичный ключ таблицы

`AUTO_INCREMENT` - позволяет указать, что значение столбца будет автоматически увеличиваться при добавлении новой строки

`UNIQUE` - казывает, что столбец может хранить только уникальные значения

`NULL и NOT NULL` - указывает что столбец может или не может принемать null

`DEFAULT` - указывает значение по умолчанию

`CHECK` - задает ограничение для диапазона значений, которые могут храниться в столбце
```SQL
CHECK((Age >0 AND Age<100) AND (Email !='') AND (Phone !=''))
```
`CONSTRAINT` - можно задать имя для ограничений на уровне таблицы с помощю CHECK

## Внешние ключи **FOREIGN KEY**
Cтолбец текущей таблицы ссылается на столбец Id таблицы Customers:
```SQL
FOREIGN KEY (CustomerId)  REFERENCES Customers (Id)
```
`ON DELETE и ON UPDATE` - спомощью выражение можно установить действия, которые выполняются соответственно при удалении и изменении связанной строки из главной таблицы

>**ДЕЙСТВИЯ:**
> 
>`CASCADE`: автоматически удаляет или изменяет строки из зависимой таблицы при удалении или изменении связанных строк в главной таблице.
> 
>`SET NULL`: при удалении или обновлении связанной строки из главной таблицы устанавливает для столбца внешнего ключа значение NULL. (В этом случае столбец внешнего ключа должен поддерживать установку NULL)
>
>`RESTRICT`: отклоняет удаление или изменение строк в главной таблице при наличии связанных строк в зависимой таблице.
>
>`NO ACTION`: то же самое, что и `RESTRICT`.
> 
>`SET DEFAULT`: при удалении связанной строки из главной таблицы устанавливает для столбца внешнего ключа значение по умолчанию, которое задается с помощью атрибуты `DEFAULT`. Несмотря на то, что данная опция в принципе доступна, однако движок `InnoDB` не поддерживает данное выражение.

`CONSTRAINT` - установка имени ограничений

>Смысл установки имен ограничений заключается в том, что впоследствии через эти  имена мы сможем управлять ограничениями - удалять или изменять их.
```SQL
CONSTRAINT customers_pk PRIMARY KEY(Id), - установка имени для ограничения PRIMARY KEY.
```
> Установить имя можно для ограничений `PRIMARY KEY`, `CHECK`, `UNIQUE`, а также `FOREIGN KEY`.

## Изменение таблиц и столбцов

>`ALTER TABLE название_таблицы` - Если таблица уже была ранее создана, и ее необходимо изменить, то для этого применяется данная команда
```SQL
ADD Address VARCHAR(50) NULL; - добавление нового столбца

DROP COLUMN Address; - удаление столбца

ALTER COLUMN Age SET DEFAULT 22; - изменение значение по умолчанию столбца Age

MODIFY COLUMN FirstName CHAR(100) NULL; - Изменим тип данных у столбца FirstName на CHAR(100) и установим для него атрибут NULL

ADD FOREIGN KEY(CustomerId) REFERENCES Customers(Id); - добавление внешнего ключа

DROP FOREIGN KEY orders_customers_fk; - удаление внешнего ключа по ограничению

ADD PRIMARY KEY (Id); - добавление первичного ключа

DROP PRIMARY KEY; - удаление первичного ключа
```

## Добавление данных. Команда INSERT
```mysql
INSERT Products(ProductName, Manufacturer, ProductCount, Price) VALUES ('iPhone X', 'Apple', 5, 76000);
- добавление в таблицу Products с столбца данные
```

>После выражения `INSERT INTO` в скобках можно указать список столбцов через запятую, в которые надо добавлять данные, и в конце после слова `VALUES` скобках перечисляют добавляемые для столбцов значения.
```sql
INSERT Products(ProductName, Manufacturer, Price, ProductCount) 
VALUES ('iPhone 8', 'Apple', 51000, 3),
        ('P20 Lite', 'Huawei', 34000, 4),
        ('Galaxy S8', 'Samsung', 46000, 2); - добавление в таблицу Products с столбца данные сразу на три строки
```

## Выборка данных. Команда SELECT
>**SELECT** список_столбцов **FROM** имя_таблицы
```sql
SELECT * FROM Products; - взять все из таблицы Products
SELECT ProductName, Price FROM Products; - взеть данные в столбцах ProductName и Price  из таблици Products
SELECT ProductName, Price * ProductCount FROM Products; - запрос с выполнением арефмитического выражения меджу столбцами 
    Price и ProductCount
SELECT ProductName AS Title, Price * ProductCount AS TotalSum FROM Products; - С помощью оператора AS можно определить его псевдоним
```

## Фильтрация данных. Оператор *WHERE*
>WHERE условие

>**SELECT** * **FROM** Products **WHERE** Manufacturer **=** 'Samsung';

>**ОПЕРАЦИИ СТАВНЕНИЕ:**
> 
>`=` - сравнение на равенство
> 
>`!=` - сравнение на неравенство
>
>`<>` - сравнение на неравенство
> 
>`<` - меньше чем
> 
>`>` - больше чем
> 
> `<=` - меньше чем или равно
> 
> `>=` - больше чем или равно
> 
```sql
SELECT * FROM Products WHERE Price * ProductCount > 100000; - запрос где произведение Price и 
ProductCount больше 100000
```


>ЛОГИЧЕСКИЕ ОПЕРАЦИИ:
> 
>`AND`: операция логического **И**
> 
>`OR`: операция логического **ИЛИ**
> 
>`NOT`: операция логического отрицания
```sql
SELECT * FROM Products WHERE Manufacturer = 'Samsung' AND Price > 50000
- выберем все товары, у которых производитель Samsung и одновременно цена больше 50000
```
```sql
SELECT * FROM Products WHERE Manufacturer ='Samsung' OR NOT (Price > 30000 AND ProductCount > 2);
- с помощью скобок можно переопределить приоретет операции
```

## Обновление данных. Команда UPDATE
